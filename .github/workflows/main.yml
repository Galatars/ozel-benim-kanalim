name: Otomatik Guncelleme

on:
  schedule:
    # Her 3 saatte bir çalıştır (YouTube engeline takılmamak için süreyi biraz açmak iyidir)
    - cron: '0 */3 * * *' 
  workflow_dispatch: # Manuel tetikleme butonu

# Bu izinler GitHub Actions'ın depoya yazabilmesi için ŞARTTIR
permissions:
  contents: write

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Depoyu Çek (Checkout)
        uses: actions/checkout@v3

      - name: Python Kur
        uses: actions/setup-python@v4
        with:
          python-version: '3.10' # Sürümü sabitlemek iyidir

      - name: Kütüphaneleri Yükle
        # requests artık zorunlu değil ama yt-dlp şart
        run: pip install yt-dlp 

      - name: Scripti Çalıştır
        # Dosya adının 'update_link.py' olduğundan emin ol!
        run: python update_link.py 

      - name: Değişiklikleri Kaydet ve Gönder
        run: |
          git config --global user.name 'GitHub Action Bot'
          git config --global user.email 'actions@github.com'
          git add sozcu.m3u
          # Eğer değişiklik yoksa hata verme, devam et
          git commit -m "Otomatik link guncellendi: $(date)" || exit 0
          git push
